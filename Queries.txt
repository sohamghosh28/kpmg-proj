SELECT LOC_ID, LOC_NAME FROM ASRIM_LOCATIONS WHERE LOC_HDR_ID = 'LH4'; --QUERY TO FETCH ALL THE STATES--

SELECT DISTINCT LOC_ID, LOC_STATE_VAL AS STATE_ID, AL.LOC_NAME AS DISTRICT FROM ASRIM_HOSPITALS AH, ASRIM_LOCATIONS AL
WHERE ISACTIVE_AP='Y'   --- Fetch Districts
AND AH.DIST_ID = AL.LOC_ID AND  AL.LOC_HDR_ID='LH6' AND LOC_STATE_VAL IN ('6', '9', '8', '7') order by LOC_STATE_VAL; 


SELECT DISTINCT LOC_ID, LOC_PARNT_ID AS DISTRICT_ID,AL.LOC_NAME AS MANDAL FROM ASRIM_HOSPITALS AH, ASRIM_LOCATIONS AL
WHERE ISACTIVE_AP='Y'   -- Fetch mandals
AND AH.DIST_ID= AL.LOC_PARNT_ID AND LOC_PARNT_ID IN (  
SELECT DISTINCT LOC_ID AS DISTRICT FROM ASRIM_HOSPITALS AH, ASRIM_LOCATIONS AL
WHERE ISACTIVE_AP='Y'
AND AH.DIST_ID = AL.LOC_ID AND  AL.LOC_HDR_ID='LH6' AND LOC_STATE_VAL = '6'
) ORDER BY LOC_PARNT_ID
; -- bASED ON DISTRICT WE ARE FETCHING THE MADALS--